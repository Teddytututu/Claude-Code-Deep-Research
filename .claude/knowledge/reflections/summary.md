# 历史失败模式摘要 (Historical Failure Patterns Summary)

本文件记录各类型研究任务中常见的失败模式，供 PreFlect 协议加载使用。

---

## 如何使用本文件

1. **PreFlect 协议** 在每次任务执行前加载本文件
2. 识别与本任务类型相关的风险模式
3. 在前瞻性批评中引用这些模式作为 evidence
4. 制定相应的预防措施

---

## 学术论文搜索类任务 (Academic Research)

### 前瞻风险清单

| 风险 | 历史频率 | 严重程度 | 前瞻检查 | 预防措施 |
|------|---------|---------|---------|---------|
| 搜索词过窄 | 高 | 高 | 是否覆盖 3+ 个相关分类？ | 使用分类组合搜索，尝试同义词 |
| 过早停止 | 高 | 严重 | 是否在开始时设置数量目标（≥5 papers）？ | 设置中期检查点，验证数量 |
| 遗漏引用链 | 中 | 高 | 是否计划追踪 key paper 的 citations？ | 添加 citation tracking 步骤 |
| 仅收集新论文 | 中 | 中 | 是否检查了基础/根源论文？ | 按引用量排序，追踪高被引论文 |
| 忽略机构信息 | 低 | 中 | 是否收集了作者机构？ | 提取 affiliations 字段 |
| 数学公式遗漏 | 低 | 低 | 是否计划提取关键公式？ | 添加 mathematical_forms 提取 |

### 典型失败场景

#### 场景 1: 搜索词过窄
```
症状: 仅收集到 2-3 篇论文
根因: 使用了过于具体的搜索词，如 "exact phrase match"
预防: 使用 OR 组合，尝试同义词，扩展分类
```

#### 场景 2: 过早停止
```
症状: 在未达到最小要求时停止搜索
根因: 没有明确的数量目标，或在时间充裕时提前结束
预防: 开始时设置明确目标（≥5 papers），过程中检查
```

#### 场景 3: 遗漏引用链
```
症状: 未能识别根基论文和继承关系
根因: 仅依赖单次搜索结果，没有追踪 citations
预防: 对高被引论文追踪其引用的根源论文
```

---

## GitHub 项目搜索类任务 (GitHub Research)

### 前瞻风险清单

| 风险 | 历史频率 | 严重程度 | 前瞻检查 | 预防措施 |
|------|---------|---------|---------|---------|
| 仅用关键词搜索 | 高 | 高 | 是否同时用 topics、language、stars 筛选？ | 多维度搜索策略 |
| 遗漏相关实现 | 高 | 严重 | 是否检查了 key paper 对应的开源实现？ | 论文→代码关联检查 |
| 低质量项目 | 中 | 中 | 是否设置了 stars 阈值？ | stars > 100 筛选 |
| 忽略架构差异 | 中 | 高 | 是否计划识别技术流派？ | 架构模式提取步骤 |
| 忽略维护状态 | 低 | 中 | 是否检查了最近更新时间？ | 筛选活跃维护项目 |
| 仓库不存在 | 中 | 中 | 是否验证目标存在性？ | 使用 git ls-remote 验证（不消耗 WebSearch） |

### 典型失败场景

#### 场景 1: 仅用关键词搜索
```
症状: 搜索结果有限，遗漏重要项目
根因: 仅用 "multi-agent" 等简单关键词
预防: 使用 topics:"multi-agent", language:Python, stars:>100 等组合
```

#### 场景 2: 遗漏相关实现
```
症状: 找到了论文但没找到对应的开源实现
根因: 没有检查论文中的 GitHub 链接
预防: 检查 arXiv 论文的 code link，搜索 paper title + github
```

#### 场景 3: 忽略架构差异
```
症状: 所有项目描述相似，没有区分技术流派
根因: 没有提取架构模式的步骤
预防: 为每个项目标注架构类型（StateGraph, Hierarchical, etc.）
```

#### 场景 4: 工具调用返回错误
```
症状: mcp__zread__* 对不存在的仓库返回错误
根因: 未验证目标存在性就调用工具
预防: 先用 git ls-remote 验证，或使用 try-catch 处理
```

---

## 社区讨论搜索类任务 (Community Research)

### 前瞻风险清单

| 风险 | 历史频率 | 严重程度 | 前瞻检查 | 预防措施 |
|------|---------|---------|---------|---------|
| 共识点识别不足 | 高 | 严重 | 是否计划每 5 个帖子提炼一次共识？ | 批量处理+定期共识提取 |
| 平台单一 | 高 | 高 | 是否覆盖 Reddit + HN + 中文社区？ | 多平台并行搜索 |
| 理论 > 实践 | 中 | 高 | 是否关注实践者观点？ | 筛选高互动帖子 |
| 遗漏争议点 | 中 | 中 | 是否计划识别分歧？ | 对比不同平台观点 |
| 情感分析缺失 | 低 | 低 | 是否计划分析情感倾向？ | 添加 sentiment 字段 |

### 典型失败场景

#### 场景 1: 共识点识别不足
```
症状: 收集了大量讨论但没有提炼出共识
根因: 只收集不分析，缺少模式识别步骤
预防: 每收集 5 个帖子，暂停并提炼共识点
```

#### 场景 2: 平台单一
```
症状: 仅收集了 Reddit 或仅收集了中文社区
根因: 没有规划多平台搜索
预防: 并行搜索 Reddit, HN, 知乎, 掘金
```

#### 场景 3: 理论 > 实践
```
症状: 收集的讨论多为理论探讨，缺少实践反馈
根因: 没有筛选实践者视角的内容
预防: 筛选高互动、有代码示例的帖子
```

---

## 通用风险模式 (Cross-Cutting Concerns)

### 时间管理风险

| 风险 | 检查 | 预防 |
|------|------|------|
| 时间不足收尾 | 是否在开始时估算任务量？ | 使用时间检查点协议 |
| 工具调用超时 | 是否有超时重试计划？ | 设置工具超时，准备降级方案 |
| 最后时刻写入失败 | 是否使用渐进式写入？ | Progressive Writing 协议 |

### 数据质量风险

| 风险 | 检查 | 预防 |
|------|------|------|
| 数据格式错误 | 是否验证输出格式？ | 使用 JSON schema 验证 |
| 字段遗漏 | 是否检查必填字段？ | 对照最小要求清单 |
| 重复数据 | 是否去重？ | 使用 MAGMAMemory 去重 |

---

## Anti-Pattern Library / 反模式库

### Anti-Pattern 1: "满足于第一个答案"
```
症状: 在找到第一个相关结果后停止
影响: 遗漏更好的结果
预防: 设置最小数量要求，强制继续搜索
```

### Anti-Pattern 2: "同质化搜索"
```
症状: 多次使用相同的搜索策略
影响: 结果多样性不足
预防: 在 PreFlect 中规划多样化的搜索策略
```

### Anti-Pattern 3: "忽略质量信号"
```
症状: 不考虑 citations、stars 等质量指标
影响: 收集低质量内容
预防: 在筛选阶段使用质量指标
```

### Anti-Pattern 4: "最后时刻冲刺"
```
症状: 在时间即将耗尽时才开始写入
影响: 写入失败或质量不达标
预防: Progressive Writing，定期保存检查点
```

---

## 更新本文件

当 Subagent 通过 Reflection Protocol 识别到新的失败模式时，应更新本文件：

1. 在相应任务类型下添加新风险
2. 记录历史频率和严重程度
3. 添加前瞻检查和预防措施
4. 如有典型场景，添加到场景列表

---

## CHANGELOG

### v1.0 (2026-02-21)

**Initial Release**:
- 学术论文搜索类任务风险（6 项）
- GitHub 项目搜索类任务风险（5 项）
- 社区讨论搜索类任务风险（5 项）
- 通用风险模式（时间管理 + 数据质量）
- 4 个反模式
- 典型失败场景描述
